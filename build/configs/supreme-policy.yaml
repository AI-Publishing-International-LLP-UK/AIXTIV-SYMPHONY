apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: supreme-zero-trust
  namespace: production-secure
  annotations:
    security.level: "SUPREME"
spec:
  podSelector:
    matchLabels:
      security-tier: "supreme"
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          environment: production-verified
          security-clearance: supreme
      podSelector:
        matchLabels:
          role: authorized-service
          security-verified: "true"
    ports:
    - port: 443
      protocol: TCP
    - port: 8443
      protocol: TCP
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          type: supreme-authorized
          security-zone: trusted
    ports:
    - port: 443
      protocol: TCP
---
apiVersion: security.gke.io/v2
kind: SupremeSecurityProfile
metadata:
  name: supreme-restricted
spec:
  podSecurityStandards:
    enforce: "restricted"
  containerSecurityContext:
    privileged: false
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    runAsNonRoot: true
    runAsUser: 1000
    capabilities:
      drop: ["ALL"]
  volumeMounts:
    - readOnly: true
  seccompProfile:
    type: RuntimeDefault
  seLinuxOptions:
    level: "s0:c123,c456"
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: supreme-admin
  annotations:
    rbac.authorization.kubernetes.io/autoupdate: "true"
rules:
- apiGroups: ["*"]
  resources: ["*"]
  verbs: ["*"]
  resourceNames: ["supreme-*"]
---
apiVersion: binauthz.gke.io/v1
kind: BinaryAuthorizationPolicy
metadata:
  name: supreme-auth-policy
spec:
  defaultAdmissionRule:
    evaluationMode: REQUIRE_ATTESTATION
    enforcementMode: ENFORCED_BLOCK_AND_AUDIT_LOG
  clusterAdmissionRules:
    "location-us-central1-a":
      evaluationMode: REQUIRE_ATTESTATION
      requireAttestationsBy:
        - "projects/supreme-project/attestors/supreme-security-attestor"
  admissionWhitelistPatterns:
  - namePattern: gcr.io/supreme-project/verified-*
---
apiVersion: monitoring.googleapis.com/v1
kind: SupremeMonitoringPolicy
metadata:
  name: supreme-monitor
spec:
  alertPolicies:
    - name: "supreme-security-breach"
      conditions:
        - name: "Unauthorized Access Attempt"
          filter: "resource.type=k8s_cluster AND severity>=ERROR"
          duration: "0s"
    - name: "supreme-compliance-violation"
      conditions:
        - name: "Compliance Check Failed"
          filter: "resource.type=k8s_cluster AND labels.compliance=violation"
          duration: "0s"
  auditConfig:
    auditLogBuckets:
      - "supreme-audit-logs"
    retentionDays: 365