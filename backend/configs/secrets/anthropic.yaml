swagger: '2.0'
info:
  title: Hugging Face Inference API Gateway
  description: |
    API Gateway for Hugging Face's Inference API services with Model Context Protocol (MCP) support.
    Enables context-aware model interactions and stateful completions.
  version: 1.0.0
  contact:
    name: HuggingFace Support
    url: https://huggingface.co/support

host: api-inference.huggingface.co
basePath: /api/v1
schemes:
  - https

security:
  - ApiKeyAuth: []
  - GoogleAuth: []

paths:
  /context:
    post:
      summary: Create a new context
      description: Initialize a new conversation context
      operationId: createContext
      parameters:
        - in: body
          name: body
          schema:
            type: object
            properties:
              initial_prompt:
                type: string
                description: Optional initial prompt to seed the context
              parameters:
                type: object
                properties:
                  context_window:
                    type: integer
                    minimum: 1
                    maximum: 4096
                    description: Maximum context window size
                    default: 2048
                  context_strategy:
                    type: string
                    enum: [sliding, fixed, truncate]
                    description: Context management strategy
                    default: sliding
      responses:
        '201':
          description: Context created successfully
          schema:
            type: object
            properties:
              context_id:
                type: string
                description: Unique identifier for the new context
              status:
                type: string
                description: Status of the context creation
              parameters:
                type: object
                description: Active context parameters
    delete:
      summary: Delete a context
      description: Remove a conversation context and associated data
      operationId: deleteContext
      parameters:
        - in: query
          name: context_id
          type: string
          required: true
          description: Context identifier to delete
      responses:
        '200':
          description: Context deleted successfully
        '404':
          description: Context not found
          
  /context/{context_id}:
    get:
      summary: Get context details
      description: Retrieve information about a specific context
      operationId: getContext
      parameters:
        - in: path
          name: context_id
          type: string
          required: true
          description: Context identifier to retrieve
      responses:
        '200':
          description: Context details retrieved successfully
          schema:
            type: object
            properties:
              context_id:
                type: string
                description: Context identifier
              created_at:
                type: string
                format: date-time
                description: When the context was created
              last_updated:
                type: string
                format: date-time
                description: When the context was last used
              turns:
                type: integer
                description: Number of interaction turns
              token_count:
                type: integer
                description: Current context size in tokens
              parameters:
                type: object
                description: Active context parameters
        '404':
          description: Context not found
  /complete:
    options:
      summary: CORS support
      description: Enable CORS by returning correct headers
      responses:
        '200':
          description: CORS headers returned
          headers:
            Access-Control-Allow-Origin:
              type: string
            Access-Control-Allow-Methods:
              type: string
            Access-Control-Allow-Headers:
              type: string
    post:
      summary: Create a completion
      description: Generate a completion using Claude AI
      operationId: createCompletion
      x-google-backend:
        address: https://drclaude.live/api/v1/complete
        path_translation: CONSTANT_ADDRESS
      parameters:
        - in: body
          name: body
          required: true
          schema:
            type: object
            required:
              - inputs
            properties:
              inputs:
                type: string
                description: The input text/prompt for the model
              context_id:
                type: string
                description: Unique identifier for the conversation context
              parameters:
                type: object
                properties:
                  temperature:
                    type: number
                    minimum: 0
                    maximum: 100
                    description: Sampling temperature
                    default: 1
                  max_new_tokens:
                    type: integer
                    minimum: 1
                    maximum: 2048
                    description: Maximum number of tokens to generate
                    default: 20
                  do_sample:
                    type: boolean
                    description: Whether to use sampling
                    default: true
                  context_window:
                    type: integer
                    minimum: 1
                    maximum: 4096
                    description: Maximum context window size in tokens
                    default: 2048
                  context_strategy:
                    type: string
                    enum: [sliding, fixed, truncate]
                    description: Strategy for handling context window overflow
                    default: sliding
      responses:
        '200':
          description: Successful completion
          headers:
            Access-Control-Allow-Origin:
              type: string
            X-Context-Id:
              type: string
              description: Current context identifier
            X-Context-Length:
              type: integer
              description: Current context length in tokens
            X-Context-Window:
              type: integer
              description: Current context window size
          schema:
            type: object
            properties:
              generated_text:
                type: string
                description: The generated text from the model
              token_usage:
                type: object
                properties:
                  total_tokens:
                    type: integer
                    description: Total number of tokens processed
                  generated_tokens:
                    type: integer
                    description: Number of tokens generated
                  context_tokens:
                    type: integer
                    description: Number of tokens in current context
              context_metadata:
                type: object
                properties:
                  context_id:
                    type: string
                    description: Unique identifier for this conversation context
                  turn_number:
                    type: integer
                    description: Current turn number in the conversation
                  context_strategy:
                    type: string
                    description: Active context management strategy
                  truncated:
                    type: boolean
                    description: Whether context was truncated
        '400':
          $ref: '#/responses/BadRequest'
        '401':
          $ref: '#/responses/Unauthorized'
        '429':
          $ref: '#/responses/TooManyRequests'
        '500':
          $ref: '#/responses/InternalError'

securityDefinitions:
  BearerAuth:
    type: apiKey
    in: header
    name: Authorization
    description: Hugging Face API token with format 'Bearer your-token'
  ApiKeyAuth:
    type: apiKey
    in: header 
    name: Authorization
    description: Bearer token for authentication
  GoogleAuth:
    type: oauth2
    flow: application
    tokenUrl: https://oauth2.googleapis.com/token
    scopes:
      https://www.googleapis.com/auth/cloud-platform: "Full access to Google Cloud Platform resources"

responses:
  BadRequest:
    description: Invalid request parameters
    schema:
      $ref: '#/definitions/Error'
  Unauthorized:
    description: Missing or invalid API key
    schema:
      $ref: '#/definitions/Error'
  TooManyRequests:
    description: Rate limit exceeded
    schema:
      $ref: '#/definitions/Error'
  InternalError:
    description: Internal server error
    schema:
      $ref: '#/definitions/Error'

definitions:
  Error:
    type: object
    required:
      - error
    properties:
      error:
        type: object
        required:
          - type
          - message
        properties:
          type:
            type: string
            description: Error type identifier
          message:
            type: string
            description: Human-readable error message
